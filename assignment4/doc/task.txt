Hive


Исходные данные

I. Логи пользователей

Данные находятся в HDFS по адресу /data/user_logs. Они состоят из трёх частей, каждая из которых находится в своей поддиректории. Данные в каждой части отличаются количеством и типом колонок, разделенных знаками табуляции (‘\t’) или пробелами.

А. Логи запросов пользователей к новостным сообщениям (user_logs).

Ip-адрес, с которого пришел запрос (STRING),
Время запроса (TIMESTAMP),
Пришедший с ip-адреса http-запрос (STRING),
Размер переданной клиенту страницы (INT),
Http-статус код (INT).
Информация о клиентском приложении, с которого осуществлялся запрос на сервер, в том числе, информация о браузере (STRING).
Важно: информация о браузере содержится в начале 6-ого поля лога (символы с нулевой позиции до позиции первого пробельного символа), содержание оставшейся части строки не определяет браузер пользователя. Разделитель между IP и временем запроса имеет 3 табуляции.

B. Информация о пользователях (user_data).

IP-адрес (STRING),
Браузер пользователя (STRING),
Пол (STRING) //male, female,
Возраст (INT).
С. Информация о местонахождении IP адресов пользователей (ip_data).

IP-адрес (STRING),
Регион (STRING).
 

Для каждой поддиректории созданы соответствующие директории с семплами, они имеют суффикс “_S”.

=============================================================================

Напишите запрос, выбирающий количество посещений от мужчин и от женщин по регионам.

Представьте, что у Вас очень много данных, и требуется обработать эти данные в кратчайший срок. Напишите запрос из задачи 4 своего варианта, но с использованием семплирования. Попробуйте различные значения процента семплов от общего объема и сравните точность получаемых оценок в зависимости от процента семплов. Результат отобразите на графике.